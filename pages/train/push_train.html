<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../../lib/layui/css/layui.css">
    <title>发布培训任务</title>
</head>

<body>
    <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
    <div class="layui-fluid">
        <form class="layui-form" action="">
            <div class="layui-card">
                <div class="layui-card-header">培训通知</div>
                <div class="layui-card-body">
                    <div class="layui-form-item">
                        <div class="layui-upload">
                            <button type="button" class="layui-btn layui-btn-normal" id="uploadNoticeBtn">选择文件</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="layui-card">
                <div class="layui-card-header">主要选项</div>
                <div class="layui-card-body">
                    <div class="layui-form-item layui-row layui-col-space5">
                        <div class="layui-col-md4">
                            <label class="layui-form-label">培训名称:</label>
                            <div class="layui-input-block">
                                <input type="text" name="title" placeholder="请输入标题" autocomplete="off" class="layui-input">
                            </div>
                        </div>
                        <div class="layui-col-md4">
                            <label class="layui-form-label">培训类型:</label>
                            <div class="layui-input-block">
                                <select name="city">
                                    <option value=""></option>
                                    <option value="0">北京</option>
                                    <option value="1">上海</option>
                                    <option value="2">广州</option>
                                    <option value="3">深圳</option>
                                    <option value="4">杭州</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-col-md4">
                            <label class="layui-form-label">培训方式:</label>
                            <div class="layui-input-block">
                                <select name="city">
                                    <option value=""></option>
                                    <option value="0">北京</option>
                                    <option value="1">上海</option>
                                    <option value="2">广州</option>
                                    <option value="3">深圳</option>
                                    <option value="4">杭州</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-col-md4">
                            <label class="layui-form-label">培训学时:</label>
                            <div class="layui-input-block">
                                <input type="text" name="title" class="layui-input" placeholder="请添加学时">
                            </div>
                        </div>
                        <div class="layui-col-md4">
                            <label class="layui-form-label">培训部门:</label>
                            <div class="layui-input-block">
                                <select name="city">
                                    <option value=""></option>
                                    <option value="0">北京</option>
                                    <option value="1">上海</option>
                                    <option value="2">广州</option>
                                    <option value="3">深圳</option>
                                    <option value="4">杭州</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-col-md4">
                            <label class="layui-form-label">培训时间:</label>
                            <div class="layui-input-block">
                                <input type="text" name="title" class="layui-input" placeholder="请选择时间">
                            </div>
                        </div>
                        <div class="layui-col-md4">
                            <label class="layui-form-label">考试图像记录周期:</label>
                            <div class="layui-input-block">
                                <select name="city">
                                    <option value=""></option>
                                    <option value="0">持续记录</option>
                                    <option value="0">持续记录</option>
                                    <option value="0">持续记录</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="layui-row layui-col-space10">
                        <div class="layui-col-md12">
                            <label class="layui-form-label">参培部门</label>
                            <div class="layui-input-block">
                                <input type="button" class="layui-btn" id='addDepartment' value="增加">
                                <input type="button" class="layui-btn" id='clearDepartment' value="清空">
                            </div>
                            <blockquote class="layui-elem-quote layui-quote-nm" style="margin-top: 10px; ">
                                <div id="parentIframeDepartment" style="margin: 0 auto;width: 90%">
                                </div>
                            </blockquote>
                        </div>
                        <div class="layui-col-md12">
                            <label class="layui-form-label">参培人员</label>
                            <div class="layui-input-block">
                                <input type="button" class="layui-btn" id='addTrainers' value="增加">
                                <input type="button" class="layui-btn" id='clearTrainers' value="清空">
                            </div>
                            <blockquote class="layui-elem-quote layui-quote-nm" style="margin-top: 10px; ">
                                <div id="parentIframeUser" style="margin: 0 auto;width: 90%">
                                </div>
                            </blockquote>
                        </div>
                        <div class="layui-col-md12">
                            <label class="layui-form-label">培训负责人</label>
                            <div class="layui-input-block">
                                <input type="button" class="layui-btn" id='addCharger' value="增加">
                                <input type="button" class="layui-btn" id='clearCharger' value="清空">
                            </div>
                            <blockquote class="layui-elem-quote layui-quote-nm" style="margin-top: 10px; ">
                                <div id="parentIframeCharger" style="margin: 0 auto;width: 90%">
                                </div>
                            </blockquote>
                        </div>
                        <div class="layui-col-md12">
                            <div class="">
                                <label class="layui-form-label">培训资料</label>
                                <div class="layui-input-block">
                                    <input type="button" class="layui-btn" id='addCourseInfo' value="增加">
                                    <input type="button" class="layui-btn" id='clearCourseInfo' value="清空">
                                </div>
                            </div>
                            <blockquote class="layui-elem-quote layui-quote-nm" style="margin-top: 10px; ">
                                <div id="parentIframeLibrarylist" style="margin: 0 auto;width: 90%">
                                </div>
                            </blockquote>
                        </div>
                        <div class="layui-col-md12">
                            <div class="layui-form-item">
                                <label class="layui-form-label">指导意见:</label>
                                <div class="layui-input-block">
                                    <textarea class="layui-textarea"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="layui-card">
                <div class="layui-card-header">其他选项</div>
                <div class="layui-card-body">
                    <div class="layui-form-item layui-row">
                        <div class="layui-col-md4 layui-col-xs12">
                            <input type="checkbox" name="" title="是否发布考试" lay-skin="primary" checked>
                        </div>
                        <div class="layui-col-md4 layui-col-xs12">
                            <input type="checkbox" name="" title="是否参与问卷调查" lay-skin="primary" checked>
                        </div>
                        <div class="layui-col-md4 layui-col-xs12">
                            <input type="checkbox" name="" title="是否留存培训影像资料" lay-skin="primary" checked>
                        </div>
                    </div>
                    <hr>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <button class="layui-btn" lay-submit lay-filter="layui-form-label">立即提交</button>
                            <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</body>
<script src="../../lib/jQuery.js"></script>
<script src="../../lib/laydate/laydate.js"></script>
<script src="../../lib/layui/layui.js"></script>
<script src="../../js/index.js"></script>
<script>
    layui.use(['layer', 'form', 'upload'], function() {
        var form = layui.form,
            layer = layui.layer,
            upload = layui.upload,
            allInputBtn = $(':button'),
            parentIframeDepartment = $('#parentIframeDepartment'),
            parentIframeUser = $('#parentIframeUser'),
            parentIframeCharger = $('#parentIframeCharger'),
            parentIframeLibrarylist = $('#parentIframeLibrarylist');

        allInputBtn.on('click', function() {
            var btnId = $(this).attr('id');
            switch (btnId) {
                case 'addDepartment':
                    openIframe('../others/receivedepartment.html');
                    break;
                case 'addTrainers':
                    openIframe('../others/receiveuser.html');
                    break;
                case 'addCharger':
                    openIframe('../others/charger.html');
                    break;
                case 'addCourseInfo':
                    openIframe('../others/librarylist.html');
                    break;
                case 'clearDepartment':
                    var departmentContent = getFatherIframeContent.init({
                        parentIframe: '#parentIframeDepartment',
                    }).getAllContentArr();
                    clearPrecinct(departmentContent, parentIframeDepartment, 'departmentArr');
                    break;
                case 'clearTrainers':
                    var userContent = getFatherIframeContent.init({
                        parentIframe: '#parentIframeUser',
                    }).getAllContentArr();
                    clearPrecinct(userContent, parentIframeUser, 'userArr');
                    break;
                case 'clearCharger':
                    var chargerContent = getFatherIframeContent.init({
                        parentIframe: '#parentIframeCharger',
                    }).getAllContentArr();
                    clearPrecinct(chargerContent, parentIframeCharger, 'charger');
                    break;
                case 'clearCourseInfo':
                    var courserInfoContent = getFatherIframeContent.init({
                        parentIframe: '#parentIframeLibrarylist',
                    }).getAllContentArr();
                    clearPrecinct(courserInfoContent, parentIframeLibrarylist, 'librarylist');
                    break;
                default:
                    break;
            }
        });

        $(document).on('click', '#delBtn_u', function() {
            $(this).parent('.userItm').remove();
            var itemId = $(this).siblings('.itemId').text();
            removeItem(object.userArr, itemId);
        });
        $(document).on('click', '#delBtn_d', function() {
            $(this).parent('.userItm').remove();
            var itemId = $(this).siblings('.itemId').text();
            removeItem(object.departmentArr, itemId);
        });
        $(document).on('click', '#delBtn_c', function() {
            $(this).parent('.userItm').remove();
            var itemId = $(this).siblings('.itemId').text();
            removeItem(object.userArr, itemId);
        });
        $(document).on('click', '#delBtn_l', function() {
            $(this).parent('.userItm').remove();
            var itemId = $(this).siblings('.itemId').text();
            removeItem(object.departmentArr, itemId);
        });

        function clearPrecinct(arr, precinct, data) {
            if (arr.length > 0) {
                layer.confirm('确认清空?', {
                    btn: ['确认', '取消'] //按钮
                }, function() {
                    layer.msg('清除成功', {
                        icon: 1
                    });
                    precinct.children().remove();
                    object[data] = [];
                }, function() {
                    layer.close();
                });
            } else {
                layer.msg('内容为空');
            }
        }

        // 通知上传
        upload.render({
            elem: '#uploadNoticeBtn',
            url: '/upload/',
            auto: false
                //,multiple: true
                ,
            bindAction: '#uploadNoticeBtn',
            done: function(res) {
                console.log(res)
            }
        });
        form.on('submit(form)', function(data) {
            console.log(data.filter);
            return false;
        });
    });
    //日期范围
    laydate.render({
        elem: '#data1',
        range: true
    });
</script>

</html>